<div *transloco="let t" class="new-content h-full no-scrollbar">
        <h5 class="page-title">{{title()}}</h5>

        @let draftContents = contentStore.draftContents();
        @let contentIsEmpty = draftContents.length === 0;

        <div *ngIf="contentIsEmpty" class="card inline-block !p-0">
                <nav class="nav px-4 py-2 flex gap-4 items-center justify-between">

                        <span></span>

                        <button (click)="openContentDialog()" class="fab" mat-mini-fab>
                                <mat-icon fontIcon="plus-fill"></mat-icon>
                        </button>
                </nav>

                <hr>

                <div class="p-4">
                        <app-empty-status [description]="t(KEY.NO_ADDED_CONTENT_MSG)" />

                </div>
        </div>

        <ng-container *ngIf="!contentIsEmpty">

                <div class="ps-1 mb-4">
                        <tui-textfield tuiTextfieldSize="m" iconStart="@tui.search">
                                <input [(ngModel)]="searchQuery" [placeholder]="t(KEY.SEARCH_PLACEHOLDER)"
                                        tuiTextfield />
                        </tui-textfield>
                </div>

                <tui-scrollbar class="!h-full">

                        <cdk-virtual-scroll-viewport #viewport appendOnly tuiScrollable
                                class="viewport tui-zero-scrollbar !h-full" [itemSize]="45" [maxBufferPx]="500"
                                [minBufferPx]="400">

                                <table *ngIf="data" tuiTable class="table" [columns]="tableColumns"
                                        [direction]="orderDirection() || 1" [tuiSortBy]="sortColumnBy()"
                                        (directionChange)="orderDirection.set($event)"
                                        (tuiSortByChange)="sortColumnBy.set($event!)">
                                        <thead>
                                                <tr tuiThGroup>
                                                        <ng-container
                                                                *ngFor="let column of tableColumns; let i = index">

                                                                @if (column === "message") {
                                                                <th *tuiHead="column" class="message-column" tuiTh
                                                                        [sticky]="true" [tuiSortable]="false"
                                                                        [style.top.px]="-(viewport.getOffsetToRenderedContentStart() || 0)">
                                                                        {{ t(column)}}
                                                                </th>
                                                                }
                                                                @else if (column === "verses") {
                                                                <th *tuiHead="column" class="verses-column" tuiTh
                                                                        [sticky]="true" [tuiSortable]="false"
                                                                        [style.top.px]="-(viewport.getOffsetToRenderedContentStart() || 0)">
                                                                        {{ t(column)}}
                                                                </th>
                                                                }
                                                                @else if (column === "keyVerse") {
                                                                <th *tuiHead="column" class="key-verse-column" tuiTh
                                                                        [sticky]="true" [tuiSortable]="false"
                                                                        [style.top.px]="-(viewport.getOffsetToRenderedContentStart() || 0)">
                                                                        {{ t(column)}}
                                                                </th>
                                                                }
                                                                @else if (column === "sn" || column ==="reference" ||
                                                                column ==="topic") {
                                                                <th *tuiHead="column" tuiSortable tuiTh [sticky]="true"
                                                                        [style.top.px]="-(viewport.getOffsetToRenderedContentStart() || 0)">
                                                                        {{ t(column)}}
                                                                </th>
                                                                }@else {
                                                                <th *tuiHead="column" [tuiSortable]="false" tuiTh
                                                                        [sticky]="true"
                                                                        [style.top.px]="-(viewport.getOffsetToRenderedContentStart() || 0)">
                                                                        {{ t(column)}}
                                                                </th>
                                                                }

                                                        </ng-container>
                                                </tr>
                                        </thead>
                                        <tbody *tuiLet="data() | tuiTableSort as sortedData" tuiTbody
                                                [data]="sortedData">
                                                <tr *ngFor="let item of sortedData" tuiTr>
                                                        <ng-container *ngFor="let key of tableColumns; let i = index">
                                                                @if (key ==="date") {
                                                                <td *tuiCell="key" tuiTd> {{ item[key] |
                                                                        date:'fullDate'
                                                                        }} </td>
                                                                }@else if (key === "message" || key === "verses"){
                                                                <td *tuiCell="key" tuiTd
                                                                        [class.match]="isColumnMatch(item[key])"> {{
                                                                        item[key]}}
                                                                </td>
                                                                }@else if (key === "imagePath"){
                                                                <td *tuiCell="key" tuiTd>
                                                                        <a [href]="item[key]" target="_blank"
                                                                                rel="noopener noreferrer">
                                                                                <img width="50" height="50"
                                                                                        class="header-image"
                                                                                        ngSrc="{{item[key]}}"
                                                                                        alt="Header Image">
                                                                        </a>
                                                                </td>
                                                                }@else if (key === "audioUrl"){
                                                                <td *tuiCell="key" tuiTd>
                                                                        <ng-audio-player *ngIf="item[key]"
                                                                                [src]="item[key]!" />
                                                                </td>
                                                                }@else if (key === "sn"){
                                                                <td *tuiCell="key" tuiTd
                                                                        [class.match]="isColumnMatch(item[key])">

                                                                        <div
                                                                                class="flex flex-col justify-between items-center h-full gap-4">
                                                                                <p>
                                                                                        {{ item[key]}}
                                                                                </p>

                                                                                <div class="flex flex-col">

                                                                                        <button [matTooltip]="t(KEY.SUBMIT_FOR_REVIEW)"
                                                                                                mat-icon-button
                                                                                                (click)="submitForReviewPrompt(item)">
                                                                                                <mat-icon
                                                                                                        fontIcon="file-upload-outline"></mat-icon>
                                                                                        </button>

                                                                                        <button [matTooltip]="t(KEY.EDIT)"
                                                                                                (click)="editContent(item)"
                                                                                                mat-icon-button>
                                                                                                <mat-icon
                                                                                                        fontIcon="pen-fill"></mat-icon>
                                                                                        </button>

                                                                                        <button [matTooltip]="t(KEY.DELETE)"
                                                                                                (click)="deleteContentPrompt(item)"
                                                                                                mat-icon-button>
                                                                                                <mat-icon
                                                                                                        class="text-orange-700"
                                                                                                        fontIcon="trash-can-fill"></mat-icon>
                                                                                        </button>

                                                                                </div>
                                                                        </div>
                                                                </td>
                                                                }@else {
                                                                <td *tuiCell="key" tuiTd
                                                                        [class.match]="isColumnMatch(item[key])"> {{
                                                                        item[key]}}
                                                                </td>
                                                                }

                                                        </ng-container>
                                                </tr>
                                        </tbody>
                                        <tfoot>
                                                <tr>
                                                        <td [colSpan]="tableColumns.length">
                                                                <tui-table-pagination class="mt-2"
                                                                        [size]="AVERAGE_TABLE_PAGE_SIZE"
                                                                        [page]="tablePage() || 0"
                                                                        [total]="contentStore.draftContents().length"
                                                                        (paginationChange)="onPagination($event)" />
                                                        </td>
                                                </tr>
                                        </tfoot>
                                </table>

                        </cdk-virtual-scroll-viewport>
                </tui-scrollbar>
        </ng-container>

</div>

<button (click)="openContentDialog()" class="!fixed right-4 bottom-4 mobile-fab fab" mat-fab>
        <mat-icon fontIcon="plus-fill"></mat-icon>
</button>